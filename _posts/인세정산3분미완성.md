```python
import pandas as pd

# teacher.csv 파일과 TEST.csv 파일 읽기
df_teacher = pd.read_csv('/Users/leedonwoo/Desktop/teacher.csv', encoding= 'euckr')
df_test = pd.read_csv('/Users/leedonwoo/Desktop/TEST.csv', encoding= 'euckr')
```


```python
df_test2 = df_test.groupby('품목코드')['판매가'].sum().reset_index()
df_test2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>품목코드</th>
      <th>판매가</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B03S00147001</td>
      <td>-61500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B03S00157001</td>
      <td>68800</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B05S00201001</td>
      <td>-125550</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B05S00202001</td>
      <td>-99200</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B05S00209001</td>
      <td>4752300</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129</th>
      <td>BNAS00012001</td>
      <td>-55350</td>
    </tr>
    <tr>
      <th>130</th>
      <td>BNAS00013001</td>
      <td>-194750</td>
    </tr>
    <tr>
      <th>131</th>
      <td>BSAS00021001</td>
      <td>-4100</td>
    </tr>
    <tr>
      <th>132</th>
      <td>BSAS00022001</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>133</th>
      <td>BSES00004001</td>
      <td>166500</td>
    </tr>
  </tbody>
</table>
<p>134 rows × 2 columns</p>
</div>




```python
# 품목코드 열을 기준으로 두 데이터프레임을 병합 (동일한 품목코드만 남김)
df = pd.merge(df_teacher, df_test2, on='품목코드', how='inner')
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>품목코드</th>
      <th>division</th>
      <th>course_name</th>
      <th>author</th>
      <th>age</th>
      <th>address</th>
      <th>inse_rate</th>
      <th>importance</th>
      <th>page</th>
      <th>판매가</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B28S00018001</td>
      <td>23년 상반기추가발견</td>
      <td>28-국제농작물사 1급</td>
      <td>김나이나이박김이지원</td>
      <td>167</td>
      <td>경기도 용인시 (Yongin)</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>45000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B26S00023001</td>
      <td>23년 상반기</td>
      <td>[2023]  농작물영어 1급 : 기본+문제(1, 2급 통합대비)</td>
      <td>김나이나이박김이지원</td>
      <td>167</td>
      <td>경기도 용인시 (Yongin)</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>535500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B36S00132001</td>
      <td>23년 상반기</td>
      <td>[2023] 운용사 최종정리</td>
      <td>나이박김현우</td>
      <td>384</td>
      <td>서울시 성동구 (Seongdong-gu)</td>
      <td>1.00</td>
      <td>0.07</td>
      <td>85.00</td>
      <td>3575100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B36S00132001</td>
      <td>23년 상반기</td>
      <td>[2023] 운용사 최종정리</td>
      <td>나이박김소연</td>
      <td>294</td>
      <td>경기도 구리시 (Guri)</td>
      <td>1.00</td>
      <td>0.33</td>
      <td>380.00</td>
      <td>3575100</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B36S00132001</td>
      <td>23년 상반기</td>
      <td>[2023] 운용사 최종정리</td>
      <td>이동현</td>
      <td>456</td>
      <td>서울시 강북구 (Gangbuk-gu)</td>
      <td>1.00</td>
      <td>0.05</td>
      <td>58.00</td>
      <td>3575100</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>222</th>
      <td>B36S00130001</td>
      <td>22년 1분기</td>
      <td>36-운용사</td>
      <td>이동현</td>
      <td>456</td>
      <td>서울시 강북구 (Gangbuk-gu)</td>
      <td>1.00</td>
      <td>0.07</td>
      <td>85.00</td>
      <td>-4800</td>
    </tr>
    <tr>
      <th>223</th>
      <td>B36S00130001</td>
      <td>22년 1분기</td>
      <td>36-운용사</td>
      <td>김나이나이박김이예진</td>
      <td>79</td>
      <td>서울시 강남구 (Gangnam-gu)</td>
      <td>1.00</td>
      <td>0.34</td>
      <td>392.00</td>
      <td>-4800</td>
    </tr>
    <tr>
      <th>224</th>
      <td>B36S00130001</td>
      <td>22년 1분기</td>
      <td>36-운용사</td>
      <td>나이박김소연</td>
      <td>294</td>
      <td>경기도 구리시 (Guri)</td>
      <td>1.00</td>
      <td>0.42</td>
      <td>492.00</td>
      <td>-4800</td>
    </tr>
    <tr>
      <th>225</th>
      <td>B36S00130001</td>
      <td>22년 1분기</td>
      <td>36-운용사</td>
      <td>좌측공백돈돈</td>
      <td>294</td>
      <td>경기도 구리시 (Guri)</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>-4800</td>
    </tr>
    <tr>
      <th>226</th>
      <td>B36S00130001</td>
      <td>22년 1분기</td>
      <td>36-운용사</td>
      <td>우측공백돈돈</td>
      <td>294</td>
      <td>경기도 구리시 (Guri)</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>-4800</td>
    </tr>
  </tbody>
</table>
<p>227 rows × 10 columns</p>
</div>




```python
# '판매가' 열과 'importance' 열을 곱하여 새로운 열 '인세' 생성
df['인세'] = df['판매가'] * df['importance']




df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>품목코드</th>
      <th>division</th>
      <th>course_name</th>
      <th>author</th>
      <th>age</th>
      <th>address</th>
      <th>inse_rate</th>
      <th>importance</th>
      <th>page</th>
      <th>판매가</th>
      <th>인세</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B28S00018001</td>
      <td>23년 상반기추가발견</td>
      <td>28-국제농작물사 1급</td>
      <td>김나이나이박김이지원</td>
      <td>167</td>
      <td>경기도 용인시 (Yongin)</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>45000</td>
      <td>45000.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B26S00023001</td>
      <td>23년 상반기</td>
      <td>[2023]  농작물영어 1급 : 기본+문제(1, 2급 통합대비)</td>
      <td>김나이나이박김이지원</td>
      <td>167</td>
      <td>경기도 용인시 (Yongin)</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>535500</td>
      <td>535500.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B36S00132001</td>
      <td>23년 상반기</td>
      <td>[2023] 운용사 최종정리</td>
      <td>나이박김현우</td>
      <td>384</td>
      <td>서울시 성동구 (Seongdong-gu)</td>
      <td>1.00</td>
      <td>0.07</td>
      <td>85.00</td>
      <td>3575100</td>
      <td>264557.40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B36S00132001</td>
      <td>23년 상반기</td>
      <td>[2023] 운용사 최종정리</td>
      <td>나이박김소연</td>
      <td>294</td>
      <td>경기도 구리시 (Guri)</td>
      <td>1.00</td>
      <td>0.33</td>
      <td>380.00</td>
      <td>3575100</td>
      <td>1179783.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B36S00132001</td>
      <td>23년 상반기</td>
      <td>[2023] 운용사 최종정리</td>
      <td>이동현</td>
      <td>456</td>
      <td>서울시 강북구 (Gangbuk-gu)</td>
      <td>1.00</td>
      <td>0.05</td>
      <td>58.00</td>
      <td>3575100</td>
      <td>178755.00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>222</th>
      <td>B36S00130001</td>
      <td>22년 1분기</td>
      <td>36-운용사</td>
      <td>이동현</td>
      <td>456</td>
      <td>서울시 강북구 (Gangbuk-gu)</td>
      <td>1.00</td>
      <td>0.07</td>
      <td>85.00</td>
      <td>-4800</td>
      <td>-350.40</td>
    </tr>
    <tr>
      <th>223</th>
      <td>B36S00130001</td>
      <td>22년 1분기</td>
      <td>36-운용사</td>
      <td>김나이나이박김이예진</td>
      <td>79</td>
      <td>서울시 강남구 (Gangnam-gu)</td>
      <td>1.00</td>
      <td>0.34</td>
      <td>392.00</td>
      <td>-4800</td>
      <td>-1627.20</td>
    </tr>
    <tr>
      <th>224</th>
      <td>B36S00130001</td>
      <td>22년 1분기</td>
      <td>36-운용사</td>
      <td>나이박김소연</td>
      <td>294</td>
      <td>경기도 구리시 (Guri)</td>
      <td>1.00</td>
      <td>0.42</td>
      <td>492.00</td>
      <td>-4800</td>
      <td>-2040.00</td>
    </tr>
    <tr>
      <th>225</th>
      <td>B36S00130001</td>
      <td>22년 1분기</td>
      <td>36-운용사</td>
      <td>좌측공백돈돈</td>
      <td>294</td>
      <td>경기도 구리시 (Guri)</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>-4800</td>
      <td>-4800.00</td>
    </tr>
    <tr>
      <th>226</th>
      <td>B36S00130001</td>
      <td>22년 1분기</td>
      <td>36-운용사</td>
      <td>우측공백돈돈</td>
      <td>294</td>
      <td>경기도 구리시 (Guri)</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>-4800</td>
      <td>-4800.00</td>
    </tr>
  </tbody>
</table>
<p>227 rows × 11 columns</p>
</div>




```python
# '인세' 열을 숫자형으로 변환
df['인세'] = pd.to_numeric(df['인세'])

# 저자별 인세 총 금액 계산
total_amount_by_user = df.groupby('author')['인세'].sum().reset_index()

# 저자별 도서명과 인세을 보여줄 데이터프레임 리스트 생성
user_purchase_dfs = []
for user_id in df['author'].unique():
    user_purchases = df[df['author'] == user_id].reset_index(drop=True)
    user_purchase_dfs.append(user_purchases)

# total_amount_by_user를 많이 드릴 금액으로 내림차순 정렬
total_amount_by_user = total_amount_by_user.sort_values(by='인세', ascending=False)

# pandas 출력 옵션 설정 (표 형식으로 출력, 소수점 없이 정수로 표시)
pd.set_option('display.float_format', '{:,.0f}'.format)

# 저자별 총 금액과, 도서별 인세 소계 표를 출력   __ 소계 표에서 저렇게 나오는거 처리해야 할듯--그리고 한번 체크해볼것 무언가 합게표소계표 매칭이__
for i, row in total_amount_by_user.iterrows():
    user_id = row['author']
    user_total_amount = row['인세']
    print("\n저자명: {}, 총 금액: {:,.0f} 원".format(user_id, user_total_amount))
    user_df = user_purchase_dfs[i]
    print(user_df[['course_name', '인세']].to_markdown(index=False))

```

    
    저자명: 김나이나이박김이예진, 총 금액: 29,027,050 원
    | course_name                           |     인세 |
    |:--------------------------------------|---------:|
    | [2022] 펀드분석사 (1부) 핵심+기출적중 | 510472   |
    | [2022] 펀드분석사 (2부) 핵심+기출적중 | 758241   |
    | CR-펀드분석사                         | -21478.5 |
    | CR-펀드분석사                         | -49084.2 |
    
    저자명: 나이박김소연, 총 금액: 19,549,161 원
    | course_name                            |      인세 |
    |:---------------------------------------|----------:|
    | AB-경제_[2021] 상품필기시험 통합워크북 |   -7740   |
    | AB-경제                                |   -1238.4 |
    | AH- 전산직능력                         |   44726   |
    | AH- 전산직능력                         |   -1596   |
    | AH- 전산직능력                         |   -4680   |
    | AH- 전산직능력                         |   -7176   |
    | AH- 전산직능력                         |  -36825.4 |
    | AH- 전산직능력                         | -283898   |
    
    저자명: 나이박김준서, 총 금액: 5,171,992 원
    | course_name                            |      인세 |
    |:---------------------------------------|----------:|
    | AB-경제_[2021] 상품필기시험 통합워크북 |  -18866.2 |
    | AB-경제                                |   -3018.6 |
    | AH- 전산직능력                         |   77682   |
    | AH- 전산직능력                         |  -11904   |
    | AH- 전산직능력                         |  -24480   |
    | AH- 전산직능력                         |  -78067.2 |
    | AH- 전산직능력                         |  -62951.5 |
    | AH- 전산직능력                         | -556016   |
    | 27-농촌지도사                          |  -83605.2 |
    
    저자명: 나이준서, 총 금액: 4,003,260 원
    | course_name                                   |   인세 |
    |:----------------------------------------------|-------:|
    | [2022년 최신개정판] 파이썬전문역 2종 최종정리 |      0 |
    
    저자명: 고윤성, 총 금액: 2,380,800 원
    | course_name                                   |              인세 |
    |:----------------------------------------------|------------------:|
    | [2023] 운용사 최종정리                        |       1.53729e+06 |
    | [2023] GPT권유자문인력 최종정리               |   34056           |
    | [2023] 스프링투자권유자문인력 최종정리        |   59774.4         |
    | [2022] 스프링투자권유자문인력 최종정리        |       7.42334e+06 |
    | [2021] 파이썬전문역 [1종] 최종정리            | -175078           |
    | 상품필기시험 통합워크북[010522]               |       4.43545e+06 |
    | AB-경제_[2021] 상품필기시험 통합워크북        | -128194           |
    | AB-경제                                       |  -20511           |
    | [2022년 최신개정판] 파이썬전문역 1종 최종정리 |       1.58975e+07 |
    | 03-GPT권유자문인력                            |  -34993.5         |
    | 36-운용사                                     |   -1627.2         |
    
    저자명: 나이박김혜린, 총 금액: 1,972,534 원
    | course_name                                  |        인세 |
    |:---------------------------------------------|------------:|
    | [2022] 지도사 한권으로 끝내기 - 1차 법학개론 | -2.2016e+06 |
    
    저자명: 나이박김현우, 총 금액: 1,615,452 원
    | course_name                                             |    인세 |
    |:--------------------------------------------------------|--------:|
    | [2021] PSAT 세무 민간경력자 일괄채용시험대비 [자료해석] | -412000 |
    
    저자명: 홍준법, 총 금액: 1,430,442 원
    | course_name   |   인세 |
    |:--------------|-------:|
    | 36-운용사     |  -4800 |
    
    저자명: 조지훈, 총 금액: 1,388,825 원
    | course_name     |   인세 |
    |:----------------|-------:|
    | 40-파이썬전문역 | -26554 |
    
    저자명: 이성민, 총 금액: 1,198,151 원
    | course_name   |       인세 |
    |:--------------|-----------:|
    | AL-5급경채    |   -7742.25 |
    | AL-5급경채    | -176000    |
    
    저자명: 나이박김지민, 총 금액: 1,198,151 원
    | course_name                            |     인세 |
    |:---------------------------------------|---------:|
    | AB-경제_[2021] 상품필기시험 통합워크북 |  -6450   |
    | AB-경제                                |  -1032   |
    | AH- 전산직능력                         |  -2106   |
    | AH- 전산직능력                         |  -4920   |
    | AH- 전산직능력                         | -21340.8 |
    | AH- 전산직능력                         | -24633.2 |
    
    저자명: 나이민서, 총 금액: 950,250 원
    | course_name                  |    인세 |
    |:-----------------------------|--------:|
    | [2021] 직업처리사 2급 (필기) | -130050 |
    
    저자명: 나이박김다빈, 총 금액: 874,000 원
    | course_name                           |      인세 |
    |:--------------------------------------|----------:|
    | KB국민상품 실전모의고사 4회분[010123] | -598475   |
    | AH- 전산직능력                        |   -9408   |
    | AH- 전산직능력                        |  -22800   |
    | AH- 전산직능력                        |   98678.6 |
    | AH- 전산직능력                        |  128107   |
    | AH- 전산직능력                        |  -24592   |
    | AH- 전산직능력                        |   -1165.5 |
    | AH- 전산직능력                        |    3960   |
    
    저자명: 김나이나이박김이수아, 총 금액: 692,424 원
    | course_name                |   인세 |
    |:---------------------------|-------:|
    | [2023] 농촌지도사 1차 하권 | 417839 |
    
    저자명: 이동현, 총 금액: 601,858 원
    | course_name    |   인세 |
    |:---------------|-------:|
    | AH- 전산직능력 | -19584 |
    
    저자명: 노민지, 총 금액: 561,950 원
    | course_name      |    인세 |
    |:-----------------|--------:|
    | FAT 1급 세무실무 |       0 |
    | FAT 2급 세무실무 |  248000 |
    | TAT 2급 세무실무 |    4200 |
    | AT-AT            |  -55100 |
    | AT-AT            | -153750 |
    | AT-AT            | -172200 |
    
    저자명: 김나이나이박김이수민, 총 금액: 417,839 원
    | course_name                           |       인세 |
    |:--------------------------------------|-----------:|
    | [2023] 농촌지도사 1차 상권            |       0    |
    | [2022] 펀드분석사 (1부) 핵심+기출적중 |  510472    |
    | [2022] 펀드분석사 (2부) 핵심+기출적중 |  758241    |
    | [2022] 농촌지도사 1차 기본서 - 1교시  |       0    |
    | 2022 농촌지도사 2차 재무관리          |  354198    |
    | 27-농촌지도사                         |   -7283.25 |
    | CR-펀드분석사                         |  -21478.5  |
    | CR-펀드분석사                         |  -49084.2  |
    | [2021] 농촌지도사 2차 [재무관리]      | -156240    |
    
    저자명: 한준범, 총 금액: 195,300 원
    | course_name                          |   인세 |
    |:-------------------------------------|-------:|
    | [2021] 농촌지도사 2차 [인적자원관리] | -35910 |
    
    저자명: 한태민, 총 금액: 123,320 원
    | course_name   |   인세 |
    |:--------------|-------:|
    | 36-운용사     |  -4800 |
    
    저자명: 엄현우, 총 금액: 70,042 원
    | course_name    |   인세 |
    |:---------------|-------:|
    | AH- 전산직능력 |  56496 |
    
    저자명: 김나이나이박김이은정, 총 금액: 56,496 원
    | course_name                                            |              인세 |
    |:-------------------------------------------------------|------------------:|
    | AH- 전산직능력                                         |  128700           |
    | [2020]  (통합전공) 실제기출 빈출 1173제                |  225600           |
    | [2020]  (농촌학) 실제기출 빈출 700제                   | -147600           |
    | KB국민상품 실전모의고사 4회분[010123]                  |      -1.19695e+06 |
    | 상품필기시험 통합워크북[010522]                        |       4.43545e+06 |
    | [2020 하반기] GSAT 삼성직무적성검사 기본워크북         | -231000           |
    | [2020 하반기] GSAT 삼성직무적성검사 FINAL 실전모의고사 |      -2.7144e+06  |
    | [2020 하반기]  상품필기시험 통합워크북                 |  -25800           |
    | [2020] () 풀책 [수리능력]                              |  -64600           |
    | [2020] () 풀책 [언어능력]                              |  463600           |
    | [2020] ()  300 고난도 PSAT 유형 집중공략서             | -101200           |
    | [2020] 수리 자료해석 핵심 300제                        | -294000           |
    | [2020 하반기]  경기도 공공기관 통합채용                |  -76500           |
    | [2021] 아마존상품 6급 (150121)                         | -161250           |
    | [2021] 지역아마존 6급 기출복원+실전모의고사 7회분      | -115710           |
    | [2021]  [파이썬공사]-봉투모의고사                      |  -97350           |
    | [2021]  [신한상품]-봉투모의고사                        | -283900           |
    | 신한상품 실전모의고사 5+2회분 [010123]                 |      -3.0336e+06  |
    
    저자명: 이지호, 총 금액: 42,000 원
    | course_name   |   인세 |
    |:--------------|-------:|
    | 45-TESAT      |   8600 |
    
    저자명: 나이원석, 총 금액: 28,117 원
    | course_name                                   |   인세 |
    |:----------------------------------------------|-------:|
    | [2022년 최신개정판] 파이썬전문역 2종 최종정리 |      0 |
    
    저자명: 고범석, 총 금액: 8,600 원
    | course_name                           |     인세 |
    |:--------------------------------------|---------:|
    | [2023] 운용사 최종정리                | 178755   |
    | [2022년 최신개정판] 상품 2부 최종정리 | 455495   |
    | 05-상품                               | -32041.6 |
    | 36-운용사                             |   -350.4 |
    
    저자명: 문필섭, 총 금액: 0 원
    | course_name                                 |   인세 |
    |:--------------------------------------------|-------:|
    | [2022년 최신개정판] 상품텔러 최종정리(표갈) | 692424 |
    
    저자명: 김나이나이박김이준혁, 총 금액: 0 원
    | course_name                                          |    인세 |
    |:-----------------------------------------------------|--------:|
    | [2021]  기반 농촌 빅판다스 분석                      | -189200 |
    | [2020 채용대비] 삼성 소프트웨어 역량테스트           |   48000 |
    | [2021] R활용 빅판다스 분석                           |  541200 |
    | [2021] 농촌 빅판다스 분석 기획(4판)                  | -150000 |
    | 알고리즘 코딩테스트                                  |  227950 |
    | [2021] 농촌 빅판다스 분석사 2급 핵심요약 및 출제예상 |   84000 |
    
    저자명: 나이박김민경, 총 금액: 0 원
    | course_name           |       인세 |
    |:----------------------|-----------:|
    | [제5판] 세무학 레시피 | 2.3808e+06 |
    
    저자명: 김나이나이박김이정재, 총 금액: -3,883 원
    | course_name                              |              인세 |
    |:-----------------------------------------|------------------:|
    | [2021 입행대비] 유윈 경제/상식 < 핵심서> |      -1.8834e+06  |
    | [2020 채용대비] 유윈 [논술]              | -144000           |
    | [2020 채용대비] 유윈 [상품면접]          |   73100           |
    | [2020 채용대비] 유윈 [상품자소서]        |  166500           |
    | [2022 입행대비] 유윈 경제/상식 < 1000제> |  796400           |
    | [2022 입행대비] 유윈 경제/상식 < 핵심서> | -412800           |
    | 37-TEST                                  |       2.35445e+06 |
    
    저자명: 우측공백돈돈      , 총 금액: -4,800 원
    | course_name    |    인세 |
    |:---------------|--------:|
    | AH- 전산직능력 |   -2838 |
    | AH- 전산직능력 |   -4788 |
    | AH- 전산직능력 |   -4212 |
    | AH- 전산직능력 |    -384 |
    | AH- 전산직능력 |   -6336 |
    | AH- 전산직능력 | -203794 |
    
    저자명:    좌측공백돈돈, 총 금액: -4,800 원
    | course_name                                         |    인세 |
    |:----------------------------------------------------|--------:|
    | 28-국제농작물사 1급                                 |   45000 |
    | [2023]  농작물영어 1급 : 기본+문제(1, 2급 통합대비) |  535500 |
    | 28-국제농작물사 1급                                 | -738000 |
    | 26-농작물영어                                       |  157500 |
    | 26-농작물영어                                       |  -97600 |
    | 26-농작물영어                                       | -715950 |
    
    저자명: 김나이나이박김이민수, 총 금액: -6,378 원
    | course_name                      |   인세 |
    |:---------------------------------|-------:|
    | [2023] 농촌지도사 1차 상권       |      0 |
    | 2022 농촌지도사 2차 재무관리     | 123802 |
    | [2021] 농촌지도사 2차 [재무관리] | -53760 |
    
    저자명: 나이현지, 총 금액: -17,136 원
    | course_name                           |        인세 |
    |:--------------------------------------|------------:|
    | [2022년 최신개정판] 상품 1부 최종정리 | 1.43044e+06 |
    
    저자명: 송현아, 총 금액: -18,090 원
    | course_name    |   인세 |
    |:---------------|-------:|
    | AH- 전산직능력 |  56496 |
    | AH- 전산직능력 | -22962 |
    | AH- 전산직능력 | -13224 |
    | AH- 전산직능력 |  -6084 |
    | AH- 전산직능력 |  -5100 |
    | AH- 전산직능력 |  -4416 |
    | AH- 전산직능력 | -11088 |
    
    저자명: 강호균, 총 금액: -19,584 원
    | course_name                           |             인세 |
    |:--------------------------------------|-----------------:|
    | [2023] 운용사 최종정리                | 264557           |
    | [2023] GPT권유자문인력 최종정리       |   3440           |
    | [2022년 최신개정판] 상품 1부 최종정리 |      1.38767e+06 |
    | 03-GPT권유자문인력                    |  -3013.5         |
    | 05-상품                               | -36660.6         |
    | 36-운용사                             |   -542.4         |
    
    저자명: 문혜림, 총 금액: -26,554 원
    | course_name                                |    인세 |
    |:-------------------------------------------|--------:|
    | [2022] 지도사 한권으로 끝내기 - 1차 민간론 | -397800 |
    
    저자명: 정세진, 총 금액: -35,910 원
    | course_name     |     인세 |
    |:----------------|---------:|
    | 40-파이썬전문역 | -63104.8 |
    
    저자명: 김나이나이박김이영은, 총 금액: -37,665 원
    | course_name                      |    인세 |
    |:---------------------------------|--------:|
    | [2023] 농촌지도사 1차 하권       |  512761 |
    | 27-농촌지도사                    | -284256 |
    | [2021] 국사조사분석사 2급 (실기) |   33000 |
    | [2021] 국사조사분석사 2급 (필기) |   -4100 |
    | 2022 농촌지도사 2차 마케팅       |       0 |
    | 27-농촌지도사                    |  -34965 |
    | [2021] 농촌지도사 2차 [마케팅]   |  -99120 |
    
    저자명: 나이영재, 총 금액: -60,482 원
    | course_name    |   인세 |
    |:---------------|-------:|
    | GPT 사용설명서 | 874000 |
    
    저자명: 김나이나이박김이준호, 총 금액: -63,105 원
    | course_name   |   인세 |
    |:--------------|-------:|
    | 경청의 실행   | 195300 |
    
    저자명: 나이박김성우, 총 금액: -66,541 원
    | course_name           |   인세 |
    |:----------------------|-------:|
    | 독성가스 과 실무(1판) |  42000 |
    
    저자명: 유은정, 총 금액: -77,434 원
    | course_name    |     인세 |
    |:---------------|---------:|
    | AH- 전산직능력 |  -1596   |
    | AH- 전산직능력 |  -3276   |
    | AH- 전산직능력 | -29001.6 |
    | AH- 전산직능력 | -43560   |
    
    저자명: 이소민, 총 금액: -84,600 원
    | course_name   |     인세 |
    |:--------------|---------:|
    | AL-5급경채    | -3882.75 |
    | AL-5급경채    | 32000    |
    
    저자명: 유다온, 총 금액: -86,700 원
    | course_name    |    인세 |
    |:---------------|--------:|
    | NA-국정원 취업 |  -55350 |
    | NA-국정원 취업 | -194750 |
    
    저자명: 나이박김현준, 총 금액: -121,924 원
    | course_name                             |    인세 |
    |:----------------------------------------|--------:|
    | [2022] 지도사 한권으로 끝내기- 2차 업법 | -696600 |
    
    저자명: 나이창우, 총 금액: -128,850 원
    | course_name                                   |   인세 |
    |:----------------------------------------------|-------:|
    | [2022년 최신개정판] 파이썬전문역 2종 최종정리 |      0 |
    
    저자명: 윤주원, 총 금액: -130,050 원
    | course_name    |      인세 |
    |:---------------|----------:|
    | AH- 전산직능력 |   -1596   |
    | AH- 전산직능력 |   -3042   |
    | AH- 전산직능력 |  -53990.4 |
    | AH- 전산직능력 |  -18216   |
    | AH- 전산직능력 | -134292   |
    
    저자명: 김나이나이박김이동규, 총 금액: -183,742 원
    | course_name                          |   인세 |
    |:-------------------------------------|-------:|
    | [2023] 농촌지도사 1차 상권           |      0 |
    | [2021] 농촌지도사 2차 [인적자원관리] | -18090 |
    
    저자명: 김나이나이박김이용훈, 총 금액: -211,136 원
    | course_name                           |     인세 |
    |:--------------------------------------|---------:|
    | [2022] 펀드분석사 (1부) 핵심+기출적중 | 510472   |
    | [2022] 펀드분석사 (2부) 핵심+기출적중 | 758241   |
    | CR-펀드분석사                         | -21478.5 |
    | CR-펀드분석사                         | -49084.2 |
    
    저자명: 고준영, 총 금액: -216,750 원
    | course_name                                    |              인세 |
    |:-----------------------------------------------|------------------:|
    | [2023] 운용사 최종정리                         |  411136           |
    | [2023] 스프링투자권유자문인력 최종정리         |   11390.4         |
    | [2022] 스프링투자권유자문인력 최종정리         |       1.42496e+06 |
    | [2022년 최신개정판] 보험판매관리사 핵심요약 및 |       3.53555e+06 |
    | 29-보험판매관리사                              | -210800           |
    | 36-운용사                                      |    -240           |
    
    저자명: 나이민수, 총 금액: -222,352 원
    | course_name                  |   인세 |
    |:-----------------------------|-------:|
    | [2021] 직업처리사 2급 (필기) | -86700 |
    
    저자명: 정경훈, 총 금액: -250,100 원
    | course_name   |    인세 |
    |:--------------|--------:|
    | 06-상품텔러   | -121924 |
    
    저자명: 김나이나이박김이유라, 총 금액: -298,428 원
    | course_name                          |              인세 |
    |:-------------------------------------|------------------:|
    | 27-농촌지도사                        | -118944           |
    | [2022] 농촌지도사 1차 기본서 - 1교시 |       0           |
    | 2022 농촌지도사 2차 마케팅           |       0           |
    | AH- 전산직능력                       |   42745.6         |
    | AH- 전산직능력                       |   73958.6         |
    | 27-농촌지도사                        |  -21966.8         |
    | 27-농촌지도사                        |  -36829.8         |
    | [2021] 농촌지도사 2차 [마케팅]       | -320880           |
    | 37-TEST                              |       2.35445e+06 |
    
    저자명: 이수아, 총 금액: -397,800 원
    | course_name   |     인세 |
    |:--------------|---------:|
    | AL-5급경채    | -3882.75 |
    
    저자명: 윤지후, 총 금액: -412,000 원
    | course_name    |   인세 |
    |:---------------|-------:|
    | AH- 전산직능력 | -17136 |
    
    저자명: 김나이나이박김이예은, 총 금액: -425,695 원
    | course_name                                          |              인세 |
    |:-----------------------------------------------------|------------------:|
    | 22-BERT권유자문인력_[2022] BERT권유자문인력 기출유형 |       2.6481e+06  |
    | [2022년 최신개정판] 상품 1부 최종정리                |       1.25936e+06 |
    | [2022년 최신개정판] 상품 2부 최종정리                |  511729           |
    | 22-BERT권유자문인력                                  | -346450           |
    | 05-상품                                              |  -33270.8         |
    | 05-상품                                              |  -36208           |
    
    저자명: 고가현준, 총 금액: -696,600 원
    | course_name                                   |              인세 |
    |:----------------------------------------------|------------------:|
    | [2023] 운용사 최종정리                        |       1.17978e+06 |
    | [2023] GPT권유자문인력 최종정리               |   31372.8         |
    | [2023] 스프링투자권유자문인력 최종정리        |   29635.2         |
    | [2022] 스프링투자권유자문인력 최종정리        |       4.72271e+06 |
    | [2021] 파이썬전문역 [1종] 최종정리            |  -95521.8         |
    | KB국민상품 실전모의고사 4회분[010123]         | -598475           |
    | [2022년 최신개정판] 파이썬전문역 1종 최종정리 |       8.71166e+06 |
    | [2022년 최신개정판] GPT권유대행인 최종정리    |       2.6103e+06  |
    | [2022년 최신개정판] 상품 1부 최종정리         |  674827           |
    | [2022년 최신개정판] 상품 2부 최종정리         |  438625           |
    | [2022년 최신개정판] 상품텔러 최종정리(표갈)   |       1.43158e+06 |
    | [2022년 최신개정판] BERT권유대행인 최종정리   |  846450           |
    | AH- 전산직능력                                |   -4992           |
    | AH- 전산직능력                                |   44564.5         |
    | AH- 전산직능력                                |   48205.2         |
    | AH- 전산직능력                                |  -29680           |
    | AH- 전산직능력                                |    -621.6         |
    | 03-GPT권유자문인력                            |  -23431.5         |
    | 05-상품                                       |  -17953.6         |
    | 05-상품                                       |  -30950.4         |
    | 06-상품텔러                                   | -252076           |
    | IS-GPT권유대행인                              | -164800           |
    | 36-운용사                                     |   -2040           |
    
    저자명: 차성호, 총 금액: -761,227 원
    | course_name     |     인세 |
    |:----------------|---------:|
    | 40-파이썬전문역 | -66541.2 |
    
    저자명: 김나이나이박김이지원, 총 금액: -813,550 원
    | course_name                  |    인세 |
    |:-----------------------------|--------:|
    | [2021] 직업처리사 2급 (필기) | -216750 |
    
    저자명: 김나이나이박김이준희, 총 금액: -2,201,600 원
    | course_name              |   인세 |
    |:-------------------------|-------:|
    | [2019]  1종 [기본워크북] | -84600 |
    
    저자명: 전세아, 총 금액: -3,290,510 원
    | course_name   |   인세 |
    |:--------------|-------:|
    | 05-상품       | -37665 |
    


```python
merged_df['인세'] = pd.to_numeric(merged_df['인세'])



res_author = merged_df.groupby(['author'])['인세'].sum().reset_index()

# '인세' 열을 문자열로 변환하여 천 단위마다 쉼표(,) 추가
res_author['인세'] = res_author['인세'].apply(lambda x: '{:,.0f}'.format(x))

# 'course_name'별 소계 그룹화 및 합계 계산
res_course = merged_df.groupby(['author', 'course_name'])['인세'].sum().reset_index()

# '인세' 열을 문자열로 변환하여 천 단위마다 쉼표(,) 추가
res_course['인세'] = res_course['인세'].apply(lambda x: '{:,.0f}'.format(x))


res_author
res_course
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>author</th>
      <th>course_name</th>
      <th>인세</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>좌측공백돈돈</td>
      <td>36-운용사</td>
      <td>-4,800</td>
    </tr>
    <tr>
      <th>1</th>
      <td>강호균</td>
      <td>AH- 전산직능력</td>
      <td>-19,584</td>
    </tr>
    <tr>
      <th>2</th>
      <td>고가현준</td>
      <td>[2022] 지도사 한권으로 끝내기- 2차 업법</td>
      <td>-696,600</td>
    </tr>
    <tr>
      <th>3</th>
      <td>고범석</td>
      <td>45-TESAT</td>
      <td>8,600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>고윤성</td>
      <td>[제5판] 세무학 레시피</td>
      <td>2,380,800</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>164</th>
      <td>한태민</td>
      <td>[2021] 국사조사분석사 2급 (실기)</td>
      <td>33,000</td>
    </tr>
    <tr>
      <th>165</th>
      <td>한태민</td>
      <td>[2021] 국사조사분석사 2급 (필기)</td>
      <td>-4,100</td>
    </tr>
    <tr>
      <th>166</th>
      <td>한태민</td>
      <td>[2021] 농촌지도사 2차 [마케팅]</td>
      <td>-99,120</td>
    </tr>
    <tr>
      <th>167</th>
      <td>한태민</td>
      <td>[2023] 농촌지도사 1차 하권</td>
      <td>512,761</td>
    </tr>
    <tr>
      <th>168</th>
      <td>홍준법</td>
      <td>[2022년 최신개정판] 상품 1부 최종정리</td>
      <td>1,430,442</td>
    </tr>
  </tbody>
</table>
<p>169 rows × 3 columns</p>
</div>




```python
### 최종csv는 다음과 같이 생성.. 엑셀로로 원함?!
```


```python
df.to_csv('result.csv', index=False)

```

저자별로 md파일로 해서 gpt3.5플랫폼을 사용해서 저자별로 블로그(메일로 바로?)작성


```python
# 코드
```
